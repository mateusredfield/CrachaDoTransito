======================== ConduApp =====================================================

Tarefas

perguntar - se precisa deixar o projeto da api rodando separado dado q os dois vao ficar separados 
ok Bug resolvido (2 a 4 horas) - o servico estava amarrado ao site mvc ainda, por isso
que dava pau em uma e na outra

- Replicar todo o fluxo acertado em PRC para Credenciamento

- Comecar modelo do super servico do json, deve ser em credenciamento

- coloca as validacoes nos demais commands

- ver se o nome das camadas esta ok

- Metodo que recebe json, json limitado por linhas e json gigante (reavaliar esse ultimo)

- Replicar tudo o que foi feito para a tabela veiculo (clean arch, proj API, swagger, keykloak)
para as tabelas (Condutor, PRC, TiposSuspensao, Tabela Bulk com a data de atualizacoes)

 - (parcial ok ) possivelmente refatorar toda a parte da viewmodel

 - colocar campo status e punicoes em prc

 - Arrumar requisao no site, addscoped httpclient, criar uma pasta separada das controllers 

 - Autenticacao no swagger

 - Passar as tabelas para o bd certo

 - Veiculo pode precisar de refatoracao pois a viewmodel deveria ser uma lista apenas

 - Deixar CPF unico (mas ainda usar id)

 - Deveria checar se nao tem um veiculo com a placa ja cadastrada (unique talvez)
 antes de colocar (durante as gravações de dados após o bulk)

 - Tabela Credenciamento (agregacao)

 - ConduApp gerado pela app, numero de serie com alguns digitos 

 - Fazer a API para envio do bulk de dados das empresas

 - Utilizar a API fingindo ser empresa pra testar em local e dev, depois treinamento
 seriam eles mesmos

 - Revisar a tabela carro depois

 - Revisar quais sao as tabelas necessarias para a primeira entrega

 - Remodelar tabelas Veiculo, Condutor, PRC, Agente de transito

 - Vai precisar cadastrar status possiveis em tabela Status 

 - bater os tipos nulls das models com os not nulls com o bd, usando builder talvez

 - Setransp -  vai ver empresa e status, e pode mudar esse

 - Qr equipe do rafa

 - (Validacao do modelo de placa) talvez nao fazer pois isso deveria ser responsabilidade
 da empresa

 - Tabela de log de acoes, com campo de log obrigatorio

- estudar novamente await, a funcao de logout foi tensa

- Trocar a base de dados para ConduApp

 - Tratativa de erros mais consisa

 - Explicitar q as emrpesas farao bulk em ambiente de treinamento, e depois em producao

- Ver diferenca entre IEnumerable e IList, ver sobre nullable pois o bd tem mtos null

- art 39 e 47 - reler

 - (futuramente/pos treinamento) Estudar git ignore para projeto Visual Studio, 
   mas talvez o template ja tenha

- (futuramente/pos treinamento) ler sobre addscoped 

- Talvez guard o bulk Perguntar o q fazer com o bulk pois seria interessante montar a api pra receber o bulk a qualquer momento e guardar isso em algum banco

- seriam 2 roles iniciais talvez pois uma seria o admin q pode tudo dentro do app e outra seria o agente de trânsito
que consultaria placas e faria mais algumas ações, então deve-se começar pela role admin e depois podar as ações para agente

- Motorista vai ter bloqueio so app e bloqueio municipal

-Usabilidade futura, qndo cair na pagina de atualizacao ja trazer os dados previos

============================================================================================

 Preciso Ler
 
  - https://learn.microsoft.com/en-us/aspnet/mvc/overview/older-versions-1/models-data/validation-with-the-data-annotation-validators-cs


============================================================================================


Anotacoes

 - 

 - Tavlez as tratativas de erro pudessem ser melhores

 - Precisa versionar o projeto exemplo pois da pra seguir dele

 - Ver onde ficam as DTOs

 - automatizado

 - Lmebrar que parece q a aplicacao fornece a interface do q ela precisa pra depois a apresentacao
 implementar essa camada

 - https://github.com/mateusredfield/CrachaDoTransito.git Keyckloak fica na infra

Talvez reler pois tem 3 tipos de injecao, construtor, propriedade e metodo
 -https://www.tutorialsteacher.com/ioc/dependency-injection#google_vignette

 - ok - Ler duvidas para reuniao, importante frizar q o pedido dos dados pode influenciar na entrega tanto da setransp qnto das empresas,
 e deixar isso homologado por email para caso ocorra atraso fica justificado

 - anotacao - DbExpress nao tem mais, agora é dblocal, nao tem limite de tamanho mas nao tem backup

 - anotacao - Reduncia pois é um projeto rapido

  - ( nao fazer ) Pegar exemplo do felipe para entender algumas modelagens. Nao fazer
 por questoes de tempo

 - Metodo pra busca parcial de placas (exmplo todas que comecem com 123, todas placas SP)

 - query tava dando pau com data annotation

 - O site mvc tem replicas da models e commands

============================================================================================

Perguntar

Bruno

  - ok - nao usar - Linha da controller
  - ok - Stream - limitadores tem seus valores no appsettings, limitar registros via controoler, ou um middleware pra controllar qntos mega
  - Se atualiza a versao da api ainda precisa recompilar o swagger, mas para o user nao deveria mudar nada
  - ok - addscoped - Se o addscoped q liga a interface a classe

- Tata

 Duvidas
 
 Tata

 - Conduapp Sendo numero senquencial poderia ser falha de seguranca

 - cronograma com as tarefas mais trabalhosas estimadas com base no tempo que os colegas levaram para fazer coisas afins

 - Ver tamanho das requisoes com a infra

 - como vai ser a tabela log, pois ela por exemplo poderia salvar tambem os updates de dados inconsistentes das empresas

 - como vai ser a tabela punições (sanções ou penalidades, ainda não sei o nome)
   Quais vao ser as punicoes possiveis Suspensao Temporaria (com data de início termino) precisa ser colocado pela setransp
   
 - Qntos digitos o conduapp vai ser  

 - Vai ter área do motorista na apliacação

 - O motorista vai portar o conduapp apenas na foma de qr code

 - Como fica a tabela Log de ações, verificar se a modelagem do bd já tem log de ações

(parcial) Conduapp - vai ser so numeros ou vai ter letras - so numeros, sequencial, so falta qntos digitos vao ser

Duvidas pra reuniao

===========================================================================================
Regras de Negocio

 - O banco aceita duplicatas por hora inezlimente em condutor
 - Problema - Nao tera acesso direto no BD pra mudar dados, seguindo politica de bd relacional
   mas eu mesmo nao gosto da ideia
 - Suspensao Temporaria (com data de inicio termino) pela Setransp mesmo (admin a priori)
 - Codigo -2 significa dados incorretos do form, seja por nulo ou improprios
 - appSettingsParts nao é usado, apenas esta la para referencia 
 - Agente de transito só consulta
 - Veiculo nao tem mesma placa, uma placa pra cada veiculo
 - ConduApp gerado pela app
 - Carro pode estar Suspenso para empresa apenas e cidade
 - Dados e consistencia ficam a cargo da empresa
 - Setransp vai ver empresa e status, e pode mudar esse
 - Qr equipe do rafa
 - Tabela de log de acoes, com campo de log obrigatorio
 - Autenticacao qndo usa API fica com a infra
 - Itinerario nao (km futuramente)
 - Deixar CPF unico (mas ainda usar id)
 - Compilacao de versoes novas de API sem derrubar o site
 - Carro pode estar Suspenso para empresa apenas e cidade
  - (nao fazer) Deveria checar a consistencia da placa talvez, talvez, pois é responsabilidade
 da empresa
 - A senha default do keykloak é 123, a usada padrao pra local dev etc é 1 a 6 ou 1 a 8Aa@
 - Keykloak role admin e gestor para meu usuario, em localhost:44310
 - Publicao do site fica em um lugar e backend api em outro
 - Status do motorista pode ser ativo inativo suspenso
 - CPF nao e unico pois vai haver incosistencias logo precisa deixar repetir, o q vai ser unico
   vai ser o id e o conduapp dele



===========================================================================================
Backlog

 ok - rever - Hello World em Clean conectando com bd

 ok - Tabela com chave, auto increment correto

 ok - Conduap -  Alinhar nome do projeto

 ok - Versionar - adicionei remoto errado sem querer mas corrigi, 
  problema foi q gastou algumas horas

 ok - Implementar command com handler proprio e implicit operator, 
 modelstate na controller para uma entendi

 ok - Validacao IO (app - regras de negocio) com commands e handlers pra 
 fazer IO - Infra
 
 ok - Validacao command (command - datasets)
 
 ok - Ver os 3 espaços de validacao
 
 ok - Conversar com a gestora sobre se deve-se falar ou nao com o cliente, pois o escopo da memoria é um e a lei nao 
 
 ok - (geladeira) -  Ressalva consideravel - A validacao esta sendo feita artesanalmente para 

 ok - coelga disse q é ok usar viewmodel com clean

 ok - Fazer o json do objeto

 ok - Falta documentos na tabela condutor

 ok -  Lembrar onde colocar o data notation

 ok - Pedido de criacao do bd fica com a tata

 ok - Versionar

 ok - Ler assinador avançado pra ver Questoes do builder e modelo de dados

ok - Clean Architerure usando template, 

ok - Pedir Permissões de projeto - Ambiente git para esse projeto

ok - duvida - Usar viewmodel ou nao, olhar como esta o projeto

ok - duvida - Checar o projeto como um todo

ok - duvida - Seria o template mais pra se basear?

ok - duvida - O Assinador avançado nao tem projeto de api no UI

ok - duvida - Pq tem model na interface do domain

ok - duvida - Handler e CQRS nao estou usando mas tb nao lmebro de ter visto no template

ok - duvida - Comentar sobre focar em um design pattern ou outro pois todos nao vai dar

ok - duvida - Falta algo do tipo DTO

ok - duvida - A aplicacao mvc conhece infra

ok - duvida - Pq o dominio tem uma interface se ele nao deve conhecer ninguem, ele nao deveria saber que metodos
ele precisaria pois ele deveria conter apenas informacao, e nao metodos pq parecem implicar em regras
de negocio da aplicacao, sendo assim o dominio deveria conhecer apenas dominio

ok - Todo command precisa ter a ida e volta

ok - Nome do app e nome do bd, Sistema Conduap

ok - duvida - Caso do motorista alegar ser registrado mas placa nem qr forem encontrados 
(possivel incosistencia no dado enviado antes)

ok - Validacao Infra (Buidler) - Infra - IO

- ok -Cronograma - Talvez usar o monday ou algo do tipo, mas nao, tfs por ser conhecido
 pelos demais, acordado em reuniao

- ok - funcionou, problema estava na callback, Testar o q ja coloquei, olhar a
callback deles

ok - Ressalva - Existem mais opcoes mas foi optado o caminho mais simplicado, apesar disso
  foi tortuoso pois a documentacao é escassa e dispersa Ler e implementar keykloak

ok - CRUD completo para PRC exceto builder, e a mais controller UI usando controller API

ok - por enquanto uma so, mas alternativa futura seria uam area pra cada empresa. No bulk pode havar empresas colocando motoristas com dados incosistentes, o q fazer
 pois cada empresa vai dar um bulk, talvez precise de uma tabela de atualizacoes, e uma tabela que guarde o bulk

ok (teoria) - O que fazer com o mer qndo tem mudanca de requisito, criar mais tabelas ou nao

ok - Frizar em pedir os dados para a setranps e as empresas ao mesmo tempo, de preferencia ja entrar em contato com a vim te buscar

ok - Ler duvidas para reuniao, importante frizar q o pedido dos dados pode influenciar na entrega tanto da setransp qnto das empresas,
 e deixar isso homologado por email para caso ocorra atraso fica justificado

ok - nao pode - Precisa checar se pode criar veículo novamente com a mesma placa (a priori acho que não deveria)

ok- um - Quantos conduapp a pessoa vai ter

ok - Se a empresa para de atuar na cidade precisaria de um status de ativo/inativo

ok - tem - Preciso saber se temos exoneração de responsabilidade quanto a consistência de dados, como telefone do motorista

ok - ficam -  Os documentos CNH etc ficam a cargo da setransp, ou o app infelizmente precisara cuidar disso

ok - futuramente - dado que a lei afirma que o vínculo da empresa precisa ser renovado após 1 ano, deveria haver uma opção de
Renovação desde já no app ou poderiamos postergar isso

ok - nao precisa - Os tokens devem ser persistidos no bd? Onde? devem ser encripatados? 

ok - setransp - Três penalidades consecutivas, punição é o app ou o admin que coloca isso

ok - futuramente dados do itinerário dos motoristas seriam relevantes ou não

ok consistencia de dados a empresa q vai ficar responsavel, o log vai dizer quem fez o q - CPF não está sendo usado com chave primaria pois precisa-se saber se ele pode estar errado e
 por algum motivo precise ser atualizado, pois a validade do mesmo apenas a receita federal pode atestar

ok - Controller PRC do site MVC finalmente usando servico da API com viewmodl e command aparentemente

ok -  Refatoracao parcial concluida

ok - Replicar todo o fluxo acertado em PRC para veiculo

ok - Replicar todo o fluxo acertado em PRC para Contudor

ok - Ver onde tratar tudo isso na entrada pq n tem trativa em nada

===========================================================================================
worklog

31-08-2023

Versionamento, Criacao das Tabelas, Fazendo a folha

01-09-23

Dentro do Clean, get, getAll, getJSon

04 e 05 - 09-2023

Tempo integralmente gasto refatorando um exemplo de clean api
que nao atende os padroes pedidos